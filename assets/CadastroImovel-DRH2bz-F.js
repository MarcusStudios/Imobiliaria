import{j as e,d as j}from"./index-CEwfpy0m.js";import{d as P,u as S,r as u}from"./vendor-WiiANj4N.js";import{h as k,f as C,u as q,q as N,r as D,n as T}from"./firebase-mGLr8wx-.js";import"./icons-E3O-J0qp.js";const R="dj16hchjj",_="imoveis_preset",F=async t=>{const l=new FormData;l.append("file",t),l.append("upload_preset",_),l.append("folder","imoveis");try{const c=await fetch(`https://api.cloudinary.com/v1_1/${R}/image/upload`,{method:"POST",body:l});if(!c.ok)throw new Error("Erro ao fazer upload da imagem");return(await c.json()).secure_url}catch(c){throw console.error("Erro no upload:",c),c}},U=async t=>{try{const l=t.map(p=>F(p));return await Promise.all(l)}catch(l){throw console.error("Erro ao fazer upload de mÃºltiplas imagens:",l),l}},z=(t,l=800)=>t.includes("cloudinary.com")?t.replace("/upload/",`/upload/w_${l},q_auto,f_auto/`):t,M=()=>{const t=P(),{id:l}=S(),[c,p]=u.useState(!1),[b,x]=u.useState(!1),[v,y]=u.useState([]),[f,g]=u.useState([]),[s,h]=u.useState({titulo:"",descricao:"",tipo:"Venda",preco:0,precoAluguel:0,endereco:"",bairro:"",cidade:"AÃ§ailÃ¢ndia",area:0,quartos:0,suites:0,banheiros:0,vagas:0,condominio:0,iptu:0,piscina:!1,churrasqueira:!1,elevador:!1,mobiliado:!1,portaria:!1,aceitaPet:!1,imagens:[],lat:-15.5518,lng:-54.298});u.useEffect(()=>{l&&(async()=>{p(!0);try{const a=await k(C(j,"imoveis",l));if(a.exists()){const r=a.data(),{id:o,...d}=r;h(d),g(d.imagens||[])}else alert("ImÃ³vel nÃ£o encontrado!"),t("/admin")}catch(a){console.error("Erro ao buscar:",a)}finally{p(!1)}})()},[l,t]);const n=i=>{const{name:a,value:r}=i.target,o=["preco","precoAluguel","area","quartos","banheiros","suites","vagas","condominio","iptu","lat","lng"].includes(a);h(d=>({...d,[a]:o?Number(r):r}))},m=i=>{const{name:a,checked:r}=i.target;h(o=>({...o,[a]:r}))},E=i=>{const a=i.target.files;if(!a||a.length===0)return;const r=Array.from(a);y(o=>[...o,...r]),r.forEach(o=>{const d=new FileReader;d.onloadend=()=>{g(A=>[...A,d.result])},d.readAsDataURL(o)})},w=i=>{g(a=>a.filter((r,o)=>o!==i)),y(a=>a.filter((r,o)=>o!==i)),l&&h(a=>({...a,imagens:a.imagens.filter((r,o)=>o!==i)}))},I=async i=>{i.preventDefault(),p(!0);try{let a=[...s.imagens];if(v.length>0){x(!0);const o=await U(v);a=[...a,...o],x(!1)}const r={...s,imagens:a};r.tipo!=="Ambos"&&(r.precoAluguel=0),l?(await q(C(j,"imoveis",l),{...r,atualizadoEm:N()}),alert("ImÃ³vel atualizado com sucesso!")):(await D(T(j,"imoveis"),{...r,criadoEm:N()}),alert("ImÃ³vel cadastrado com sucesso!")),t("/")}catch(a){console.error("Erro ao salvar:",a);const r=a instanceof Error?a.message:"Erro desconhecido";alert("Erro ao salvar: "+r)}finally{p(!1),x(!1)}};return e.jsxs("div",{className:"container",style:{padding:"2rem 0",maxWidth:"900px"},children:[e.jsx("h1",{children:l?"âœï¸ Editar ImÃ³vel":"ðŸ  Cadastrar Novo ImÃ³vel"}),e.jsx("div",{className:"card",style:{padding:"2rem",marginTop:"1rem",border:"none",boxShadow:"none",background:"transparent"},children:e.jsxs("form",{onSubmit:I,style:{display:"grid"},children:[e.jsxs("section",{children:[e.jsx("h3",{children:"InformaÃ§Ãµes Principais"}),e.jsxs("div",{style:{display:"grid",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"TÃ­tulo"}),e.jsx("input",{name:"titulo",value:s.titulo,onChange:n,className:"input-control",required:!0,placeholder:"Ex: Apartamento no Centro com Vista"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Finalidade"}),e.jsxs("select",{name:"tipo",value:s.tipo,onChange:n,className:"input-control",children:[e.jsx("option",{value:"Venda",children:"Venda"}),e.jsx("option",{value:"Aluguel",children:"Aluguel"}),e.jsx("option",{value:"Ambos",children:"Ambos"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:s.tipo==="Aluguel"?"Aluguel (R$)":"Venda (R$)"}),e.jsx("input",{name:"preco",type:"number",value:s.preco||"",onChange:n,className:"input-control",required:!0,placeholder:"Ex: 350000"})]}),s.tipo==="Ambos"&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Aluguel (R$)"}),e.jsx("input",{name:"precoAluguel",type:"number",value:s.precoAluguel||"",onChange:n,className:"input-control",required:!0,placeholder:"Ex: 2500"})]})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{children:"LocalizaÃ§Ã£o"}),e.jsxs("div",{style:{display:"grid",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"EndereÃ§o"}),e.jsx("input",{name:"endereco",value:s.endereco,onChange:n,className:"input-control",required:!0,placeholder:"Ex: Rua das Palmeiras, 123"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bairro"}),e.jsx("input",{name:"bairro",value:s.bairro,onChange:n,className:"input-control",required:!0,placeholder:"Ex: Jardim Imperial"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cidade"}),e.jsx("input",{name:"cidade",value:s.cidade,onChange:n,className:"input-control",placeholder:"Ex: Primavera do Leste"})]})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{children:"Detalhes"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Ãrea (mÂ²)"}),e.jsx("input",{name:"area",type:"number",value:s.area||"",onChange:n,className:"input-control",placeholder:"Ex: 120"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Quartos"}),e.jsx("input",{name:"quartos",type:"number",value:s.quartos||"",onChange:n,className:"input-control",placeholder:"Ex: 3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"SuÃ­tes"}),e.jsx("input",{name:"suites",type:"number",value:s.suites||"",onChange:n,className:"input-control",placeholder:"Ex: 1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Banh."}),e.jsx("input",{name:"banheiros",type:"number",value:s.banheiros||"",onChange:n,className:"input-control",placeholder:"Ex: 2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vagas"}),e.jsx("input",{name:"vagas",type:"number",value:s.vagas||"",onChange:n,className:"input-control",placeholder:"Ex: 2"})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{children:"Custos Extras"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"CondomÃ­nio (R$)"}),e.jsx("input",{name:"condominio",type:"number",value:s.condominio||"",onChange:n,className:"input-control",placeholder:"Ex: 450"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"IPTU (R$)"}),e.jsx("input",{name:"iptu",type:"number",value:s.iptu||"",onChange:n,className:"input-control",placeholder:"Ex: 1200"})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{children:"Comodidades"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"1rem"},children:[e.jsxs("label",{style:{display:"flex",gap:"8px",alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",name:"piscina",checked:s.piscina,onChange:m,style:{width:"18px",height:"18px"}})," Piscina"]}),e.jsxs("label",{style:{display:"flex",gap:"8px",alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",name:"churrasqueira",checked:s.churrasqueira,onChange:m,style:{width:"18px",height:"18px"}})," Churrasqueira"]}),e.jsxs("label",{style:{display:"flex",gap:"8px",alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",name:"elevador",checked:s.elevador,onChange:m,style:{width:"18px",height:"18px"}})," Elevador"]}),e.jsxs("label",{style:{display:"flex",gap:"8px",alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",name:"mobiliado",checked:s.mobiliado,onChange:m,style:{width:"18px",height:"18px"}})," Mobiliado"]}),e.jsxs("label",{style:{display:"flex",gap:"8px",alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",name:"portaria",checked:s.portaria,onChange:m,style:{width:"18px",height:"18px"}})," Portaria"]}),e.jsxs("label",{style:{display:"flex",gap:"8px",alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",name:"aceitaPet",checked:s.aceitaPet,onChange:m,style:{width:"18px",height:"18px"}})," Aceita Pet"]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{children:"ðŸ“¸ Fotos do ImÃ³vel"}),e.jsxs("div",{style:{display:"grid",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Adicionar Fotos"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:E,className:"input-control",style:{padding:"0.5rem"}}),e.jsx("small",{style:{color:"#666",fontSize:"0.85rem"},children:"Selecione atÃ© 10 fotos. Formatos: JPG, PNG, WEBP"})]}),f.length>0&&e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"1rem",marginTop:"1rem"},children:f.map((i,a)=>e.jsxs("div",{style:{position:"relative",aspectRatio:"4/3",borderRadius:"8px",overflow:"hidden",border:"2px solid #ddd"},children:[e.jsx("img",{src:i.includes("cloudinary")?z(i,300):i,alt:`Preview ${a+1}`,style:{width:"100%",height:"100%",objectFit:"cover"}}),e.jsx("button",{type:"button",onClick:()=>w(a),style:{position:"absolute",top:"5px",right:"5px",background:"rgba(255, 0, 0, 0.8)",color:"white",border:"none",borderRadius:"50%",width:"28px",height:"28px",cursor:"pointer",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:"Ã—"})]},a))})]})]}),e.jsxs("section",{children:[e.jsx("label",{className:"label",children:"DescriÃ§Ã£o"}),e.jsx("textarea",{name:"descricao",rows:6,value:s.descricao,onChange:n,className:"input-control",style:{height:"auto"},placeholder:"Ex: ImÃ³vel recÃ©m reformado, prÃ³ximo a escolas e supermercados. Possui acabamento em porcelanato..."})]}),e.jsx("button",{type:"submit",className:"btn-details",style:{background:"var(--primary)",color:"white",marginTop:"1rem"},disabled:c||b,children:b?"ðŸ“¤ Enviando imagens...":c?"ðŸ’¾ Salvando...":"âœ… Salvar ImÃ³vel"})]})})]})};export{M as CadastroImovel};
