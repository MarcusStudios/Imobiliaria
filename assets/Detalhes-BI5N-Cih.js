import{j as e,W as R,a as E,c as I,I as L,d as k,e as S,b as P,u as A,f as F}from"./index-soNUMr-L.js";import{r as c,e as B,L as v}from"./vendor-Bpbu6qE6.js";import{k as D,j as $,u as q,n as M}from"./firebase-CIAoV_1m.js";import{C as y,a as N,X as T,m as U,M as w,Z as W,A as O,n as j,o as V,j as Y,p as Q,q as _,b as G,B as H,c as K,r as Z}from"./icons-HRjz0DnP.js";const X=({images:r,altBase:i="Imóvel"})=>{const[a,n]=c.useState(0),[l,d]=c.useState(!1),p=c.useRef(null),x=()=>{n(s=>(s+1)%r.length)},b=()=>{n(s=>(s-1+r.length)%r.length)},g=s=>{n(s),d(!0)},u=()=>{d(!1)};return c.useEffect(()=>{l&&p.current?.focus();const s=o=>{o.key==="Escape"&&u()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[l]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{role:"button",tabIndex:0,"aria-label":`Ampliar foto ${a+1} de ${r.length} de ${i}`,style:{position:"relative",width:"100%",aspectRatio:"16 / 9",borderRadius:"12px",overflow:"hidden",background:"#f1f5f9",cursor:"pointer"},onClick:()=>g(a),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),g(a))},children:[e.jsx("img",{src:r[a],alt:`Foto ${a+1} de ${r.length} — ${i}`,style:{width:"100%",height:"100%",objectFit:"cover"}}),r.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),b()},"aria-label":`Foto anterior (${a===0?r.length:a} de ${r.length})`,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",background:"rgba(0, 0, 0, 0.4)",border:"1px solid rgba(255, 255, 255, 0.5)",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s",color:"#fff"},children:e.jsx(y,{size:24,"aria-hidden":"true"})}),e.jsx("button",{onClick:s=>{s.stopPropagation(),x()},"aria-label":`Próxima foto (${a+2>r.length?1:a+2} de ${r.length})`,style:{position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%)",background:"rgba(0, 0, 0, 0.4)",border:"1px solid rgba(255, 255, 255, 0.5)",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s",color:"#fff"},children:e.jsx(N,{size:24,"aria-hidden":"true"})}),e.jsxs("div",{"aria-hidden":"true",style:{position:"absolute",bottom:"1rem",right:"1rem",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"0.5rem 1rem",borderRadius:"20px",fontSize:"0.875rem",fontWeight:500},children:[a+1," / ",r.length]})]})]}),r.length>1&&e.jsx("div",{role:"list","aria-label":"Miniaturas das fotos",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(80px, 1fr))",gap:"0.5rem",marginTop:"0.75rem",maxHeight:"100px",overflowX:"auto"},children:r.map((s,o)=>e.jsx("button",{role:"listitem",onClick:()=>n(o),"aria-label":`Ver foto ${o+1} de ${r.length}`,"aria-current":a===o?"true":void 0,style:{aspectRatio:"1 / 1",borderRadius:"6px",overflow:"hidden",cursor:"pointer",border:a===o?"3px solid var(--primary)":"2px solid #e2e8f0",opacity:a===o?1:.6,transition:"all 0.2s",padding:0,background:"none"},children:e.jsx("img",{src:s,alt:`Miniatura ${o+1} — ${i}`,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})},o))})]}),l&&e.jsxs("div",{role:"dialog","aria-modal":"true","aria-label":`Galeria de fotos — ${i}. Foto ${a+1} de ${r.length}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.95)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},onClick:u,children:[e.jsx("button",{ref:p,onClick:u,"aria-label":"Fechar galeria",style:{position:"absolute",top:"1rem",right:"1rem",background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:1e4},children:e.jsx(T,{size:28,color:"#1e293b","aria-hidden":"true"})}),e.jsx("img",{src:r[a],alt:`Foto ${a+1} de ${r.length} — ${i} (ampliada)`,style:{maxWidth:"90%",maxHeight:"90%",objectFit:"contain",borderRadius:"8px"},onClick:s=>s.stopPropagation()}),r.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),b()},"aria-label":`Foto anterior (${a===0?r.length:a} de ${r.length})`,style:{position:"absolute",left:"2rem",top:"50%",transform:"translateY(-50%)",background:"rgba(0, 0, 0, 0.5)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"50%",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"background 0.2s"},children:e.jsx(y,{size:28,"aria-hidden":"true"})}),e.jsx("button",{onClick:s=>{s.stopPropagation(),x()},"aria-label":`Próxima foto (${a+2>r.length?1:a+2} de ${r.length})`,style:{position:"absolute",right:"2rem",top:"50%",transform:"translateY(-50%)",background:"rgba(0, 0, 0, 0.5)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"50%",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"background 0.2s"},children:e.jsx(N,{size:28,"aria-hidden":"true"})}),e.jsxs("div",{"aria-hidden":"true",style:{position:"absolute",bottom:"2rem",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"0.75rem 1.5rem",borderRadius:"25px",fontSize:"1rem",fontWeight:500},children:[a+1," / ",r.length]})]})]})]})},C=({imovel:r})=>{const i=`${R}?text=Olá Lidiany! Vi o imóvel ${r.titulo.toUpperCase()} (Cód: ${r.id?.slice(0,6).toUpperCase()}) e gostaria de mais informações.`;return e.jsxs("div",{className:"price-card",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"price-label",children:["Valor de ",r.tipo]}),e.jsx("h2",{className:"price-value",children:Number(r.preco).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]}),r.tipo==="Ambos"&&(r.precoAluguel??0)>0&&e.jsxs("div",{className:"rent-container",children:[e.jsx("p",{className:"rent-label",children:"OU ALUGUEL POR:"}),e.jsxs("p",{className:"rent-value",children:[Number(r.precoAluguel).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),e.jsx("span",{style:{fontSize:"0.9rem",fontWeight:400,color:"#64748b"},children:"/mês"})]})]}),(Number(r.condominio)>0||Number(r.iptu)>0)&&e.jsxs("div",{className:"extra-costs",children:[Number(r.condominio)>0&&e.jsxs("div",{className:"cost-row",children:[e.jsxs("span",{className:"cost-label",children:[e.jsx(U,{size:14})," Condomínio"]}),e.jsx("strong",{className:"cost-value",children:Number(r.condominio).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]}),Number(r.iptu)>0&&e.jsxs("div",{className:"cost-row",style:{marginTop:Number(r.condominio)>0?"8px":0},children:[e.jsxs("span",{className:"cost-label",children:[e.jsx(w,{size:14})," IPTU (anual)"]}),e.jsx("strong",{className:"cost-value",children:Number(r.iptu).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]})]}),e.jsx("div",{style:{display:"grid",gap:"1rem"},children:e.jsxs("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"btn-whatsapp","aria-label":`Chamar no WhatsApp sobre o imóvel: ${r.titulo}`,children:[e.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"Chamar no WhatsApp"]})}),e.jsx("div",{className:"quick-reply-info",children:e.jsxs("div",{className:"reply-badge",children:[e.jsx(W,{size:16,fill:"currentColor"})," Resposta rápida"]})})]})},J=r=>{const i=E();return I({queryKey:["imovel",r],queryFn:async()=>{if(!r)throw new Error("ID não fornecido");const a=i.getQueryData(L);if(a){const l=a.find(d=>d.id===r);if(l)return l}const n=await D($(k,"imoveis",r));if(!n.exists())throw new Error("Imóvel não encontrado");return{id:n.id,...n.data()}},enabled:!!r,staleTime:600*1e3,gcTime:1800*1e3})},te=()=>{const{id:r}=B(),{isAdmin:i}=S(),{data:a,isLoading:n}=J(r),{data:l=[]}=P(),d=c.useMemo(()=>!a||l.length===0?[]:l.filter(t=>t.id!==r&&t.ativo!==!1&&t.tipo===a.tipo&&t.categoria===a.categoria).slice(0,4),[a,l,r]);A({title:a?`${a.titulo} - ${a.cidade}`:"Carregando imóvel...",description:a?`${a.tipo} em ${a.bairro}, ${a.cidade}. ${a.quartos} quartos, ${a.area}m². Lidiany Lopes - Moriá Imóveis.`:void 0});const[p,x]=c.useState(!1);if(c.useEffect(()=>{window.scrollTo(0,0)},[r]),c.useEffect(()=>{!r||!a||i||q($(k,"imoveis",r),{visualizacoes:M(1)}).catch(t=>console.error("Erro ao registrar visualização:",t))},[r,a,i]),n)return e.jsx("div",{className:"container",style:{padding:"4rem",textAlign:"center"},children:"Carregando..."});if(!a)return e.jsx("div",{className:"container",children:"Imóvel não encontrado"});const b=a.imagens&&a.imagens.length>0?a.imagens:["/sem-foto.png"],g=t=>{if(!t)return"";const h="toDate"in t?t.toDate():t;return new Intl.DateTimeFormat("pt-BR",{dateStyle:"long"}).format(h)},u=a.atualizadoEm?a.atualizadoEm:a.criadoEm,s=a.atualizadoEm?"Atualizado em":"Publicado em",o=r?r.slice(0,6).toUpperCase():"",m=(t,h)=>t?e.jsxs("div",{className:"comodidade-badge",children:[e.jsx(j,{size:16,color:"var(--success)"}),h]}):null,z=async()=>{const t=window.location.href,h=a.titulo||"Confira este imóvel";if(navigator.share)try{await navigator.share({title:h,url:t})}catch(f){console.log("Erro ao compartilhar",f)}else try{await navigator.clipboard.writeText(t),x(!0),setTimeout(()=>x(!1),2e3)}catch(f){console.error("Erro ao copiar link",f)}};return e.jsxs("div",{className:"detalhes-page",children:[e.jsxs("div",{className:"container detalhes-header-container",children:[e.jsxs("div",{className:"detalhes-nav-bar",children:[e.jsxs(v,{to:"/",className:"detalhes-back-link",children:[e.jsx(O,{size:20})," Voltar"]}),e.jsxs("div",{className:"detalhes-actions",children:[e.jsx("button",{className:"btn-share",onClick:z,style:p?{color:"var(--success)",borderColor:"var(--success)",backgroundColor:"#f0fdf4"}:{},children:p?e.jsxs(e.Fragment,{children:[e.jsx(j,{size:16})," Copiado!"]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{size:16})," Compartilhar"]})}),i&&e.jsxs(v,{to:`/editar/${a.id}`,className:"btn-details",style:{width:"auto",background:"var(--secondary)",marginTop:0},children:[e.jsx(Y,{size:16})," Editar"]})]})]}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"detalhes-tags-container",children:[e.jsx("span",{className:"tag-tipo",children:a.tipo}),a.destaque&&e.jsx("span",{className:"tag-destaque",children:"Destaque"}),e.jsxs("span",{className:"tag-codigo",children:["Código: ",o]}),e.jsxs("div",{className:"detalhes-dates",children:[u&&e.jsxs("span",{className:"date-info",children:[e.jsx(Q,{size:14})," ",s," ",e.jsx("b",{children:g(u)})]}),a.criadoEm&&!a.atualizadoEm&&e.jsxs("span",{className:"date-info",children:[e.jsx(_,{size:14})," Criado em"," ",e.jsx("b",{children:g(a.criadoEm)})]})]})]}),e.jsx("h1",{className:"detalhes-title",children:a.titulo}),e.jsx("div",{className:"detalhes-location",children:e.jsxs("div",{className:"location-item",children:[e.jsx(w,{size:18})," ",a.endereco," - ",a.bairro,","," ",a.cidade]})})]})]}),e.jsxs("div",{className:"container details-layout",children:[e.jsxs("div",{className:"details-column-left",children:[e.jsx(X,{images:b,altBase:a.titulo}),e.jsx("div",{className:"mobile-price-container",children:e.jsx(C,{imovel:a})}),e.jsx("div",{className:"features-grid",children:[{icon:G,label:"Área Útil",val:`${a.area} m²`},{icon:H,label:"Quartos",val:a.quartos},{icon:j,label:"Suítes",val:a.suites||"-"},{icon:K,label:"Banheiros",val:a.banheiros},{icon:Z,label:"Vagas",val:a.vagas||"-"}].map((t,h)=>e.jsxs("div",{className:"feature-item",children:[e.jsx(t.icon,{size:24,className:"feature-icon"}),e.jsx("div",{className:"feature-value",children:t.val}),e.jsx("div",{className:"feature-label",children:t.label})]},h))}),e.jsxs("div",{className:"description-section",children:[e.jsx("h3",{className:"section-title",children:"Sobre o imóvel"}),e.jsx("p",{className:"description-text",children:a.descricao})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"section-title",children:"Diferenciais"}),e.jsxs("div",{className:"comodidades-list",children:[m(a.piscina,"Piscina"),m(a.churrasqueira,"Churrasqueira"),m(a.elevador,"Elevador"),m(a.mobiliado,"Mobiliado"),m(a.portaria,"Portaria 24h"),m(a.aceitaPet,"Aceita Pet")]})]})]}),e.jsx("aside",{className:"desktop-sidebar",children:e.jsx(C,{imovel:a})})]}),d.length>0&&e.jsx("div",{style:{backgroundColor:"var(--bg-page)",padding:"4rem 0",marginTop:"4rem",borderTop:"1px solid #e2e8f0"},children:e.jsxs("div",{className:"container",children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:800,marginBottom:"2rem",color:"var(--text-main)"},children:"Você também pode se interessar"}),e.jsx("div",{className:"imoveis-grid",children:d.map(t=>e.jsx(F,{imovel:t},t.id))})]})})]})};export{te as Detalhes};
