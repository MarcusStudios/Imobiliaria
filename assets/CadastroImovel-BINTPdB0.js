import{j as e,d as z}from"./index-CZpKUOUo.js";import{e as D,d as T,r as m,L as k}from"./vendor-DPpvCZNn.js";import{h as F,f as A,u as M,q as I,r as U,n as V}from"./firebase-mGLr8wx-.js";import{A as _,v as $,w as L,X as G,x as O}from"./icons-oDxEi2-m.js";const H="dj16hchjj",J="imoveis_preset",Q=async d=>{const t=new FormData;t.append("file",d),t.append("upload_preset",J),t.append("folder","imoveis");try{const n=await fetch(`https://api.cloudinary.com/v1_1/${H}/image/upload`,{method:"POST",body:t});if(!n.ok)throw new Error("Erro ao fazer upload da imagem");return(await n.json()).secure_url}catch(n){throw console.error("Erro no upload:",n),n}},X=async d=>{try{const t=d.map(c=>Q(c));return await Promise.all(t)}catch(t){throw console.error("Erro ao fazer upload de m√∫ltiplas imagens:",t),t}},K=(d,t=800)=>d.includes("cloudinary.com")?d.replace("/upload/",`/upload/w_${t},q_auto,f_auto/`):d,ae=()=>{const d=D(),{id:t}=T(),[n,c]=m.useState(!1),[g,b]=m.useState(!1),[w,x]=m.useState(0),[y,B]=m.useState([]),[h,v]=m.useState([]),[C,N]=m.useState([]),[o,f]=m.useState({titulo:"",descricao:"",tipo:"Venda",preco:0,precoAluguel:0,endereco:"",bairro:"",cidade:"A√ßail√¢ndia",area:0,quartos:0,suites:0,banheiros:0,vagas:0,condominio:0,iptu:0,piscina:!1,churrasqueira:!1,elevador:!1,mobiliado:!1,portaria:!1,aceitaPet:!1,imagens:[],lat:-15.5518,lng:-54.298,ativo:!0,destaque:!1});m.useEffect(()=>{t&&(async()=>{c(!0);try{const a=await F(A(z,"imoveis",t));if(a.exists()){const i=a.data(),{id:l,...p}=i;f(p),v(p.imagens||[])}else alert("Im√≥vel n√£o encontrado!"),d("/admin")}catch(a){console.error("Erro ao buscar:",a)}finally{c(!1)}})()},[t,d]);const s=r=>{const{name:a,value:i}=r.target,l=["preco","precoAluguel","area","quartos","banheiros","suites","vagas","condominio","iptu","lat","lng"].includes(a);f(p=>({...p,[a]:l?Number(i):i}))},j=r=>{const{name:a,checked:i}=r.target;f(l=>({...l,[a]:i}))},E=r=>{const a=r.target.files;if(!a||a.length===0)return;const i=Array.from(a);if(h.length+i.length>10){alert(`Voc√™ pode adicionar no m√°ximo 10 fotos. Atualmente h√° ${h.length} foto(s).`);return}if(i.filter(u=>u.size>5*1024*1024).length>0){alert("Algumas imagens s√£o muito grandes (m√°x 5MB). Por favor, comprima-as antes de fazer upload.");return}B(u=>[...u,...i]),i.forEach(u=>{const S=new FileReader;S.onloadend=()=>{v(W=>[...W,S.result])},S.readAsDataURL(u)})},R=r=>{v(a=>a.filter((i,l)=>l!==r)),B(a=>a.filter((i,l)=>l!==r)),t&&f(a=>({...a,imagens:a.imagens.filter((i,l)=>l!==r)}))},P=()=>{const r=[];return o.titulo.trim()||r.push("T√≠tulo √© obrigat√≥rio"),o.preco<=0&&r.push("Pre√ßo deve ser maior que zero"),o.tipo==="Ambos"&&(!o.precoAluguel||o.precoAluguel<=0)&&r.push('Pre√ßo de aluguel √© obrigat√≥rio quando o tipo √© "Ambos"'),o.endereco.trim()||r.push("Endere√ßo √© obrigat√≥rio"),o.bairro.trim()||r.push("Bairro √© obrigat√≥rio"),h.length===0&&y.length===0&&r.push("Adicione pelo menos uma foto do im√≥vel"),N(r),r.length===0},q=async r=>{if(r.preventDefault(),!P()){window.scrollTo({top:0,behavior:"smooth"});return}c(!0);try{let a=[...o.imagens];if(y.length>0){b(!0),x(0);const l=setInterval(()=>{x(u=>Math.min(u+10,90))},200),p=await X(y);a=[...a,...p],clearInterval(l),x(100),b(!1)}const i={...o,imagens:a};i.tipo!=="Ambos"&&(i.precoAluguel=0),t?(await M(A(z,"imoveis",t),{...i,atualizadoEm:I()}),alert("‚úÖ Im√≥vel atualizado com sucesso!")):(await U(V(z,"imoveis"),{...i,criadoEm:I()}),alert("‚úÖ Im√≥vel cadastrado com sucesso!")),d("/admin")}catch(a){console.error("Erro ao salvar:",a);const i=a instanceof Error?a.message:"Erro desconhecido";alert("‚ùå Erro ao salvar: "+i)}finally{c(!1),b(!1),x(0)}};return e.jsx("div",{style:{background:"#f8fafc",minHeight:"100vh",paddingBottom:"4rem"},children:e.jsxs("div",{className:"container",style:{padding:"2rem 1rem",maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs("div",{style:{background:"white",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsxs(k,{to:"/admin",style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",color:"#64748b",textDecoration:"none",fontSize:"0.9rem",marginBottom:"1rem",transition:"color 0.2s"},onMouseEnter:r=>r.currentTarget.style.color="var(--primary)",onMouseLeave:r=>r.currentTarget.style.color="#64748b",children:[e.jsx(_,{size:18})," Voltar ao painel"]}),e.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#1e293b"},children:t?"‚úèÔ∏è Editar Im√≥vel":"üè† Cadastrar Novo Im√≥vel"}),e.jsx("p",{style:{margin:"0.5rem 0 0",color:"#64748b",fontSize:"0.95rem"},children:t?"Atualize as informa√ß√µes do im√≥vel":"Preencha os dados do novo im√≥vel"})]}),C.length>0&&e.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx($,{size:20,color:"#ef4444"}),e.jsx("strong",{style:{color:"#991b1b"},children:"Corrija os seguintes erros:"})]}),e.jsx("ul",{style:{margin:"0.5rem 0 0 1.5rem",color:"#7f1d1d"},children:C.map((r,a)=>e.jsx("li",{children:r},a))})]}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",marginBottom:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1.5rem",fontSize:"1.25rem",color:"#1e293b",paddingBottom:"0.75rem",borderBottom:"2px solid #f1f5f9"},children:"üìã Informa√ß√µes Principais"}),e.jsxs("div",{style:{display:"grid",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"T√≠tulo do An√∫ncio *"}),e.jsx("input",{name:"titulo",value:o.titulo,onChange:s,className:"input-control",required:!0,placeholder:"Ex: Apartamento Moderno no Centro com Vista",style:{fontSize:"1rem"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"Finalidade *"}),e.jsxs("select",{name:"tipo",value:o.tipo,onChange:s,className:"input-control",style:{fontSize:"1rem"},children:[e.jsx("option",{value:"Venda",children:"Venda"}),e.jsx("option",{value:"Aluguel",children:"Aluguel"}),e.jsx("option",{value:"Ambos",children:"Venda ou Aluguel"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:o.tipo==="Aluguel"?"Valor do Aluguel (R$) *":"Valor de Venda (R$) *"}),e.jsx("input",{name:"preco",type:"number",value:o.preco||"",onChange:s,className:"input-control",required:!0,placeholder:"350000",style:{fontSize:"1rem"}})]}),o.tipo==="Ambos"&&e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"Valor do Aluguel (R$) *"}),e.jsx("input",{name:"precoAluguel",type:"number",value:o.precoAluguel||"",onChange:s,className:"input-control",required:!0,placeholder:"2500",style:{fontSize:"1rem"}})]})]})]})]}),e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",marginBottom:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1.5rem",fontSize:"1.25rem",color:"#1e293b",paddingBottom:"0.75rem",borderBottom:"2px solid #f1f5f9"},children:"üìç Localiza√ß√£o"}),e.jsxs("div",{style:{display:"grid",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"Endere√ßo Completo *"}),e.jsx("input",{name:"endereco",value:o.endereco,onChange:s,className:"input-control",required:!0,placeholder:"Ex: Rua das Palmeiras, 123",style:{fontSize:"1rem"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"Bairro *"}),e.jsx("input",{name:"bairro",value:o.bairro,onChange:s,className:"input-control",required:!0,placeholder:"Ex: Jardim Imperial",style:{fontSize:"1rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"Cidade"}),e.jsx("input",{name:"cidade",value:o.cidade,onChange:s,className:"input-control",placeholder:"A√ßail√¢ndia",style:{fontSize:"1rem"}})]})]})]})]}),e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",marginBottom:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1.5rem",fontSize:"1.25rem",color:"#1e293b",paddingBottom:"0.75rem",borderBottom:"2px solid #f1f5f9"},children:"üè° Caracter√≠sticas do Im√≥vel"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"√Årea (m¬≤)"}),e.jsx("input",{name:"area",type:"number",value:o.area||"",onChange:s,className:"input-control",placeholder:"120",style:{fontSize:"1rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"Quartos"}),e.jsx("input",{name:"quartos",type:"number",value:o.quartos||"",onChange:s,className:"input-control",placeholder:"3",style:{fontSize:"1rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"Su√≠tes"}),e.jsx("input",{name:"suites",type:"number",value:o.suites||"",onChange:s,className:"input-control",placeholder:"1",style:{fontSize:"1rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"Banheiros"}),e.jsx("input",{name:"banheiros",type:"number",value:o.banheiros||"",onChange:s,className:"input-control",placeholder:"2",style:{fontSize:"1rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"Vagas"}),e.jsx("input",{name:"vagas",type:"number",value:o.vagas||"",onChange:s,className:"input-control",placeholder:"2",style:{fontSize:"1rem"}})]})]})]}),e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",marginBottom:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1.5rem",fontSize:"1.25rem",color:"#1e293b",paddingBottom:"0.75rem",borderBottom:"2px solid #f1f5f9"},children:"üí∞ Custos Adicionais"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"Condom√≠nio (R$/m√™s)"}),e.jsx("input",{name:"condominio",type:"number",value:o.condominio||"",onChange:s,className:"input-control",placeholder:"450",style:{fontSize:"1rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",style:{fontWeight:600,marginBottom:"0.5rem",display:"block"},children:"IPTU (R$/ano)"}),e.jsx("input",{name:"iptu",type:"number",value:o.iptu||"",onChange:s,className:"input-control",placeholder:"1200",style:{fontSize:"1rem"}})]})]})]}),e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",marginBottom:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1.5rem",fontSize:"1.25rem",color:"#1e293b",paddingBottom:"0.75rem",borderBottom:"2px solid #f1f5f9"},children:"‚ú® Comodidades"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"1rem"},children:[{name:"piscina",label:"üèä Piscina"},{name:"churrasqueira",label:"üî• Churrasqueira"},{name:"elevador",label:"üõó Elevador"},{name:"mobiliado",label:"üõãÔ∏è Mobiliado"},{name:"portaria",label:"üö™ Portaria 24h"},{name:"aceitaPet",label:"üêï Aceita Pet"}].map(r=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",padding:"0.75rem",background:o[r.name]?"#f0fdf4":"#f8fafc",border:o[r.name]?"2px solid #22c55e":"2px solid #e2e8f0",borderRadius:"8px",transition:"all 0.2s"},children:[e.jsx("input",{type:"checkbox",name:r.name,checked:o[r.name],onChange:j,style:{width:"20px",height:"20px",cursor:"pointer"}}),e.jsx("span",{style:{fontSize:"0.95rem",fontWeight:500},children:r.label})]},r.name))})]}),e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",marginBottom:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1.5rem",fontSize:"1.25rem",color:"#1e293b",paddingBottom:"0.75rem",borderBottom:"2px solid #f1f5f9"},children:"üì∏ Fotos do Im√≥vel *"}),e.jsxs("div",{style:{display:"grid",gap:"1.5rem"},children:[e.jsxs("div",{style:{border:"2px dashed #cbd5e1",borderRadius:"12px",padding:"2rem",textAlign:"center",background:"#f8fafc",position:"relative"},children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:E,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,cursor:"pointer"}}),e.jsx(L,{size:48,color:"#94a3b8",style:{margin:"0 auto 1rem"}}),e.jsx("p",{style:{margin:"0 0 0.5rem",fontSize:"1.1rem",fontWeight:600,color:"#334155"},children:"Clique ou arraste fotos aqui"}),e.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:"#64748b"},children:"M√°ximo 10 fotos ‚Ä¢ JPG, PNG ou WEBP ‚Ä¢ M√°x 5MB cada"}),e.jsxs("p",{style:{margin:"0.5rem 0 0",fontSize:"0.875rem",color:"#64748b"},children:[h.length,"/10 fotos adicionadas"]})]}),g&&e.jsxs("div",{children:[e.jsx("div",{style:{background:"#e2e8f0",height:"8px",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{background:"var(--primary)",height:"100%",width:`${w}%`,transition:"width 0.3s ease"}})}),e.jsxs("p",{style:{margin:"0.5rem 0 0",fontSize:"0.875rem",color:"#64748b",textAlign:"center"},children:["Enviando fotos... ",w,"%"]})]}),h.length>0&&e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:"1rem"},children:h.map((r,a)=>e.jsxs("div",{style:{position:"relative",aspectRatio:"4/3",borderRadius:"12px",overflow:"hidden",border:"2px solid #e2e8f0",background:"#f8fafc"},children:[a===0&&e.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",background:"var(--primary)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"0.75rem",fontWeight:600,zIndex:2},children:"CAPA"}),e.jsx("img",{src:r.includes("cloudinary")?K(r,300):r,alt:`Preview ${a+1}`,style:{width:"100%",height:"100%",objectFit:"cover"}}),e.jsx("button",{type:"button",onClick:()=>R(a),style:{position:"absolute",top:"8px",right:"8px",background:"rgba(239, 68, 68, 0.95)",color:"white",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",zIndex:2},children:e.jsx(G,{size:18})})]},a))})]})]}),e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",marginBottom:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1.5rem",fontSize:"1.25rem",color:"#1e293b",paddingBottom:"0.75rem",borderBottom:"2px solid #f1f5f9"},children:"üìù Descri√ß√£o Detalhada"}),e.jsx("textarea",{name:"descricao",rows:8,value:o.descricao,onChange:s,className:"input-control",placeholder:"Descreva o im√≥vel em detalhes: acabamentos, localiza√ß√£o, diferenciais, proximidade de com√©rcios, escolas, etc.",style:{fontSize:"1rem",lineHeight:1.6,resize:"vertical"}}),e.jsxs("p",{style:{margin:"0.5rem 0 0",fontSize:"0.875rem",color:"#64748b"},children:[o.descricao.length," caracteres"]})]}),e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",marginBottom:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1.5rem",fontSize:"1.25rem",color:"#1e293b",paddingBottom:"0.75rem",borderBottom:"2px solid #f1f5f9"},children:"‚öôÔ∏è Configura√ß√µes de Publica√ß√£o"}),e.jsxs("div",{style:{display:"grid",gap:"1rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"12px",cursor:"pointer",padding:"1rem",background:"#f8fafc",borderRadius:"8px",border:"2px solid #e2e8f0"},children:[e.jsx("input",{type:"checkbox",name:"ativo",checked:o.ativo,onChange:j,style:{width:"20px",height:"20px",marginTop:"2px",cursor:"pointer"}}),e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:"1rem",color:"#1e293b",display:"block",marginBottom:"4px"},children:"Publicar Imediatamente"}),e.jsx("small",{style:{color:"#64748b",fontSize:"0.875rem"},children:"Desmarque para salvar como rascunho (n√£o aparecer√° no site)"})]})]}),e.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"12px",cursor:"pointer",padding:"1rem",background:o.destaque?"#fef3c7":"#f8fafc",borderRadius:"8px",border:o.destaque?"2px solid #fbbf24":"2px solid #e2e8f0"},children:[e.jsx("input",{type:"checkbox",name:"destaque",checked:o.destaque,onChange:j,style:{width:"20px",height:"20px",marginTop:"2px",cursor:"pointer"}}),e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:"1rem",color:"#1e293b",display:"block",marginBottom:"4px"},children:"‚≠ê Marcar como Destaque"}),e.jsx("small",{style:{color:"#64748b",fontSize:"0.875rem"},children:"Im√≥vel aparecer√° com badge especial e ter√° prioridade na listagem"})]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end",flexWrap:"wrap"},children:[e.jsx(k,{to:"/admin",style:{padding:"1rem 2rem",borderRadius:"8px",border:"2px solid #e2e8f0",background:"white",color:"#64748b",fontSize:"1rem",fontWeight:600,textDecoration:"none",display:"inline-flex",alignItems:"center",gap:"8px",cursor:"pointer",transition:"all 0.2s"},children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:n||g,style:{padding:"1rem 2rem",borderRadius:"8px",border:"none",background:n||g?"#cbd5e1":"var(--primary)",color:"white",fontSize:"1rem",fontWeight:600,cursor:n||g?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",gap:"8px",transition:"all 0.2s",boxShadow:n||g?"none":"0 4px 6px rgba(0,0,0,0.1)"},children:g?e.jsx(e.Fragment,{children:"üì§ Enviando imagens..."}):n?e.jsx(e.Fragment,{children:"üíæ Salvando..."}):e.jsxs(e.Fragment,{children:[e.jsx(O,{size:20}),t?"Atualizar Im√≥vel":"Cadastrar Im√≥vel"]})})]})]})]})})};export{ae as CadastroImovel};
