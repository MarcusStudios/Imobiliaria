import{j as s,u as k,a as C,b as S,d as v,I as N}from"./index-soNUMr-L.js";import{L as j,r as m}from"./vendor-Bpbu6qE6.js";import{u as $,j as p,m as M}from"./firebase-CIAoV_1m.js";import{e as V,E as b,T as f,D as y,f as I,S as L,g as R,h as T,P as g,i as q,M as F,j as B,k as O,l as U}from"./icons-HRjz0DnP.js";const Q=({stats:i})=>s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"stats-grid",children:[s.jsx("div",{className:"stat-card primary",children:s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{children:[s.jsx("p",{className:"stat-title",children:"Total de ImÃ³veis"}),s.jsx("h3",{className:"stat-value",children:i.totalImoveis})]}),s.jsx(V,{size:32,className:"stat-icon"})]})}),s.jsx("div",{className:"stat-card secondary",children:s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{children:[s.jsx("p",{className:"stat-title",children:"Ativos"}),s.jsx("h3",{className:"stat-value",children:i.imoveisAtivos})]}),s.jsx(b,{size:32,className:"stat-icon"})]})}),s.jsx("div",{className:"stat-card info",children:s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{children:[s.jsx("p",{className:"stat-title",children:"Para Venda"}),s.jsx("h3",{className:"stat-value",children:i.imoveisVenda})]}),s.jsx(f,{size:32,className:"stat-icon"})]})}),s.jsx("div",{className:"stat-card success",children:s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{children:[s.jsx("p",{className:"stat-title",children:"Para Aluguel"}),s.jsx("h3",{className:"stat-value",children:i.imoveisAluguel})]}),s.jsx(y,{size:32,className:"stat-icon"})]})})]}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"secondary-stats-card",children:[s.jsxs("div",{className:"stat-header",children:[s.jsx(I,{size:20,color:"#64748b"}),s.jsx("p",{children:"Novos (30 dias)"})]}),s.jsx("h3",{className:"stat-number",children:i.cadastradosUltimos30Dias})]}),s.jsxs("div",{className:"secondary-stats-card",children:[s.jsxs("div",{className:"stat-header",children:[s.jsx(L,{size:20,color:"#fbbf24"}),s.jsx("p",{children:"Em Destaque"})]}),s.jsx("h3",{className:"stat-number",children:i.emDestaque})]}),s.jsxs("div",{className:"secondary-stats-card",children:[s.jsxs("div",{className:"stat-header",children:[s.jsx(R,{size:20,color:"#64748b"}),s.jsx("p",{children:"Sem Fotos"})]}),s.jsx("h3",{className:`stat-number ${i.semFoto>0?"red":"green"}`,children:i.semFoto})]}),s.jsxs("div",{className:"secondary-stats-card",children:[s.jsxs("div",{className:"stat-header",children:[s.jsx(T,{size:20,color:"#64748b"}),s.jsx("p",{children:"Valor MÃ©dio"})]}),s.jsx("h3",{className:"stat-number currency",children:i.valorMedioVenda.toLocaleString("pt-BR",{style:"currency",currency:"BRL",maximumFractionDigits:0})})]})]})]}),P=({faixasPreco:i,maisVisualizados:r})=>{const d=Math.max(i.ate200k,i.de200a400k,i.de400a600k,i.acima600k);return s.jsxs("div",{className:"charts-grid",children:[s.jsxs("div",{className:"chart-card",children:[s.jsx("h3",{className:"chart-title",children:"ðŸ’° DistribuiÃ§Ã£o por Faixa de PreÃ§o"}),s.jsx("div",{className:"chart-content",children:[{label:"AtÃ© R$ 200mil",valor:i.ate200k,cor:"#22c55e"},{label:"R$ 200mil - R$ 400mil",valor:i.de200a400k,cor:"#3b82f6"},{label:"R$ 400mil - R$ 600mil",valor:i.de400a600k,cor:"#f59e0b"},{label:"Acima de R$ 600mil",valor:i.acima600k,cor:"#8b5cf6"}].map((c,n)=>s.jsxs("div",{className:"price-dist-item",children:[s.jsxs("div",{className:"price-dist-header",children:[s.jsx("span",{className:"price-label",children:c.label}),s.jsx("span",{className:"price-value",children:c.valor})]}),s.jsx("div",{className:"price-bar-bg",children:s.jsx("div",{className:"price-bar-fill",style:{width:`${d>0?c.valor/d*100:0}%`,background:c.cor}})})]},n))})]}),s.jsxs("div",{className:"chart-card",children:[s.jsx("h3",{className:"chart-title",children:"ðŸ”¥ ImÃ³veis Mais Visualizados"}),r.length>0?s.jsx("div",{className:"top-viewed-list",children:r.map((c,n)=>s.jsxs("div",{className:`top-viewed-item ${n===0?"highlight":"normal"}`,children:[s.jsx("span",{className:`rank-badge ${n===0?"highlight":"normal"}`,children:n+1}),s.jsxs("div",{className:"viewed-info",children:[s.jsx("p",{className:"viewed-title",children:c.titulo}),s.jsxs("p",{className:"viewed-count",children:[c.visualizacoes," visualizaÃ§Ãµes"]})]})]},c.id))}):s.jsx("p",{className:"empty-state-text",children:"Nenhuma visualizaÃ§Ã£o registrada ainda"})]})]})},H=({imoveis:i,onDelete:r,onToggleStatus:d,filtro:c,setFiltro:n,busca:o,setBusca:u})=>s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"actions-bar",children:[s.jsxs("div",{className:"actions-header",children:[s.jsx("div",{className:"filter-buttons",children:["todos","ativos","venda","aluguel","rascunho"].map(t=>s.jsx("button",{onClick:()=>n(t),className:`filter-btn ${c===t?"active":"inactive"}`,children:t==="todos"?"Todos":t==="ativos"?"Ativos":t},t))}),s.jsxs("div",{style:{display:"flex",gap:"8px"},children:[s.jsxs(j,{to:"/admin/terrenos/novo",className:"btn-new",style:{backgroundColor:"#10b981"},children:[s.jsx(g,{size:20})," Novo Terreno"]}),s.jsxs(j,{to:"/cadastro-imovel",className:"btn-new",children:[s.jsx(g,{size:20})," Novo ImÃ³vel"]})]})]}),s.jsxs("div",{className:"search-wrapper",children:[s.jsx(q,{size:20,className:"search-icon"}),s.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar por tÃ­tulo, endereÃ§o ou bairro...",value:o,onChange:t=>u(t.target.value)})]})]}),s.jsxs("div",{className:"imoveis-list-container",children:[s.jsx("div",{className:"list-header",children:s.jsxs("h3",{children:["ðŸ“‹ Lista de ImÃ³veis (",i.length,")"]})}),s.jsxs("div",{className:"list-content",children:[i.map(t=>s.jsxs("div",{className:`imovel-item ${t.ativo===!1?"inactive":t.destaque?"destaque":"active"}`,children:[s.jsxs("div",{className:"imovel-info",children:[s.jsx("img",{src:t.imagens?.[0]||"/sem-foto.png",alt:"Capa",className:"imovel-thumb",loading:"lazy"}),s.jsxs("div",{className:"imovel-details",children:[s.jsxs("h4",{children:[t.titulo," ",t.destaque&&s.jsx("span",{className:"badge-destaque",children:"â­ DESTAQUE"})]}),s.jsxs("div",{className:"imovel-meta",children:[s.jsxs("span",{className:"meta-row",children:[s.jsx(f,{size:12})," ",t.tipo," â€¢",s.jsx(y,{size:12}),Number(t.preco).toLocaleString("pt-BR",{style:"currency",currency:"BRL",maximumFractionDigits:0})]}),s.jsxs("span",{className:"meta-row",children:[s.jsx(F,{size:12})," ",t.endereco,t.bairro&&` - ${t.bairro}`]})]}),t.ativo===!1&&s.jsx("span",{className:"badge-draft",children:"RASCUNHO"})]})]}),s.jsxs("div",{className:"item-actions",children:[s.jsx(j,{to:t.categoria==="Terreno"?`/admin/terrenos/editar/${t.id}`:`/editar/${t.id}`,className:"action-btn edit",title:"Editar",children:s.jsx(B,{size:18})}),s.jsx("button",{onClick:()=>d(t.id,t.ativo??!0),className:`action-btn toggle ${t.ativo===!1?"inactive":""}`,title:t.ativo===!1?"Publicar":"Ocultar",children:t.ativo===!1?s.jsx(O,{size:18}):s.jsx(b,{size:18})}),s.jsx("button",{onClick:()=>r(t.id),className:"action-btn delete",title:"Excluir",children:s.jsx(U,{size:18})})]})]},t.id)),i.length===0&&s.jsxs("div",{className:"empty-state-list",children:[s.jsx("p",{className:"empty-title",children:o?"ðŸ” Nenhum imÃ³vel encontrado com esse termo":"ðŸ“­ Nenhum imÃ³vel nesta categoria"}),s.jsx("p",{className:"empty-desc",children:o?"Tente buscar por outro termo":'Clique em "Novo ImÃ³vel" para comeÃ§ar'})]})]})]})]}),J=()=>{k({title:"Painel Administrativo",description:"Dashboard de gerenciamento de imÃ³veis."});const i=C(),{data:r=[],isLoading:d}=S(),[c,n]=m.useState("todos"),[o,u]=m.useState(""),t=m.useMemo(()=>{const a=new Date;return a.setDate(a.getDate()-30),{totalImoveis:r.length,imoveisAtivos:r.filter(e=>e.ativo!==!1).length,imoveisVenda:r.filter(e=>e.tipo==="Venda"||e.tipo==="Ambos").length,imoveisAluguel:r.filter(e=>e.tipo==="Aluguel"||e.tipo==="Ambos").length,totalVisualizacoes:r.reduce((e,l)=>e+(l.visualizacoes||0),0),cadastradosUltimos30Dias:r.filter(e=>e.criadoEm?("toDate"in e.criadoEm?e.criadoEm.toDate():e.criadoEm instanceof Date?e.criadoEm:new Date)>=a:!1).length,semFoto:r.filter(e=>!e.imagens||e.imagens.length===0).length,emDestaque:r.filter(e=>e.destaque===!0).length,valorMedioVenda:Math.round(r.filter(e=>e.tipo==="Venda"||e.tipo==="Ambos").reduce((e,l)=>e+l.preco,0)/(r.filter(e=>e.tipo==="Venda"||e.tipo==="Ambos").length||1))}},[r]),z=m.useMemo(()=>r.filter(a=>{if(c==="venda"&&a.tipo!=="Venda"&&a.tipo!=="Ambos"||c==="aluguel"&&a.tipo!=="Aluguel"&&a.tipo!=="Ambos"||c==="rascunho"&&a.ativo!==!1||c==="ativos"&&a.ativo===!1)return!1;if(o){const e=o.toLowerCase();return a.titulo.toLowerCase().includes(e)||a.endereco.toLowerCase().includes(e)||a.bairro&&a.bairro.toLowerCase().includes(e)}return!0}),[r,c,o]),D=m.useMemo(()=>[...r].filter(a=>(a.visualizacoes||0)>0).sort((a,e)=>(e.visualizacoes||0)-(a.visualizacoes||0)).slice(0,5),[r]),A=m.useMemo(()=>({ate200k:r.filter(a=>a.preco<=2e5).length,de200a400k:r.filter(a=>a.preco>2e5&&a.preco<=4e5).length,de400a600k:r.filter(a=>a.preco>4e5&&a.preco<=6e5).length,acima600k:r.filter(a=>a.preco>6e5).length}),[r]),E=async a=>{if(window.confirm("Tem certeza que deseja excluir? Essa aÃ§Ã£o Ã© permanente."))try{await M(p(v,"imoveis",a)),i.setQueryData(N,l=>l?l.filter(h=>h.id!==a):[])}catch(l){console.error("Erro ao excluir:",l),alert("Erro ao excluir.")}},w=async(a,e)=>{try{const l=!e;await $(p(v,"imoveis",a),{ativo:l}),i.setQueryData(N,h=>h?h.map(x=>x.id===a?{...x,ativo:l}:x):[])}catch(l){console.error("Erro ao atualizar status:",l)}};return d?s.jsx("div",{className:"loading-state",children:"Carregando painel..."}):s.jsxs("div",{className:"admin-container",children:[s.jsxs("div",{className:"admin-header",children:[s.jsx("h2",{children:"ðŸ“Š Dashboard Administrativo"}),s.jsx("p",{children:"VisÃ£o geral dos seus imÃ³veis e estatÃ­sticas"})]}),s.jsx(Q,{stats:t}),s.jsx(P,{faixasPreco:A,maisVisualizados:D}),s.jsx(H,{imoveis:z,onDelete:E,onToggleStatus:w,filtro:c,setFiltro:n,busca:o,setBusca:u})]})};export{J as Admin};
