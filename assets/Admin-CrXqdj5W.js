import{j as s,u as k,d as j}from"./index-djdnOkB1.js";import{L as v,r as n}from"./vendor-Bpbu6qE6.js";import{m as C,n as $,u as q,f as p,p as L}from"./firebase-DDoP64bi.js";import{e as M,E as g,T as b,D as f,f as T,S as V,g as F,h as R,P as N,i as I,M as B,j as O,k as U,l as P}from"./icons-HRjz0DnP.js";const H=({stats:e})=>s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"stats-grid",children:[s.jsx("div",{className:"stat-card primary",children:s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{children:[s.jsx("p",{className:"stat-title",children:"Total de ImÃ³veis"}),s.jsx("h3",{className:"stat-value",children:e.totalImoveis})]}),s.jsx(M,{size:32,className:"stat-icon"})]})}),s.jsx("div",{className:"stat-card secondary",children:s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{children:[s.jsx("p",{className:"stat-title",children:"Ativos"}),s.jsx("h3",{className:"stat-value",children:e.imoveisAtivos})]}),s.jsx(g,{size:32,className:"stat-icon"})]})}),s.jsx("div",{className:"stat-card info",children:s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{children:[s.jsx("p",{className:"stat-title",children:"Para Venda"}),s.jsx("h3",{className:"stat-value",children:e.imoveisVenda})]}),s.jsx(b,{size:32,className:"stat-icon"})]})}),s.jsx("div",{className:"stat-card success",children:s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{children:[s.jsx("p",{className:"stat-title",children:"Para Aluguel"}),s.jsx("h3",{className:"stat-value",children:e.imoveisAluguel})]}),s.jsx(f,{size:32,className:"stat-icon"})]})})]}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"secondary-stats-card",children:[s.jsxs("div",{className:"stat-header",children:[s.jsx(T,{size:20,color:"#64748b"}),s.jsx("p",{children:"Novos (30 dias)"})]}),s.jsx("h3",{className:"stat-number",children:e.cadastradosUltimos30Dias})]}),s.jsxs("div",{className:"secondary-stats-card",children:[s.jsxs("div",{className:"stat-header",children:[s.jsx(V,{size:20,color:"#fbbf24"}),s.jsx("p",{children:"Em Destaque"})]}),s.jsx("h3",{className:"stat-number",children:e.emDestaque})]}),s.jsxs("div",{className:"secondary-stats-card",children:[s.jsxs("div",{className:"stat-header",children:[s.jsx(F,{size:20,color:"#64748b"}),s.jsx("p",{children:"Sem Fotos"})]}),s.jsx("h3",{className:`stat-number ${e.semFoto>0?"red":"green"}`,children:e.semFoto})]}),s.jsxs("div",{className:"secondary-stats-card",children:[s.jsxs("div",{className:"stat-header",children:[s.jsx(R,{size:20,color:"#64748b"}),s.jsx("p",{children:"Valor MÃ©dio"})]}),s.jsx("h3",{className:"stat-number currency",children:e.valorMedioVenda.toLocaleString("pt-BR",{style:"currency",currency:"BRL",maximumFractionDigits:0})})]})]})]}),Q=({faixasPreco:e,maisVisualizados:o})=>{const d=Math.max(e.ate200k,e.de200a400k,e.de400a600k,e.acima600k);return s.jsxs("div",{className:"charts-grid",children:[s.jsxs("div",{className:"chart-card",children:[s.jsx("h3",{className:"chart-title",children:"ðŸ’° DistribuiÃ§Ã£o por Faixa de PreÃ§o"}),s.jsx("div",{className:"chart-content",children:[{label:"AtÃ© R$ 200mil",valor:e.ate200k,cor:"#22c55e"},{label:"R$ 200mil - R$ 400mil",valor:e.de200a400k,cor:"#3b82f6"},{label:"R$ 400mil - R$ 600mil",valor:e.de400a600k,cor:"#f59e0b"},{label:"Acima de R$ 600mil",valor:e.acima600k,cor:"#8b5cf6"}].map((l,c)=>s.jsxs("div",{className:"price-dist-item",children:[s.jsxs("div",{className:"price-dist-header",children:[s.jsx("span",{className:"price-label",children:l.label}),s.jsx("span",{className:"price-value",children:l.valor})]}),s.jsx("div",{className:"price-bar-bg",children:s.jsx("div",{className:"price-bar-fill",style:{width:`${d>0?l.valor/d*100:0}%`,background:l.cor}})})]},c))})]}),s.jsxs("div",{className:"chart-card",children:[s.jsx("h3",{className:"chart-title",children:"ðŸ”¥ ImÃ³veis Mais Visualizados"}),o.length>0?s.jsx("div",{className:"top-viewed-list",children:o.map((l,c)=>s.jsxs("div",{className:`top-viewed-item ${c===0?"highlight":"normal"}`,children:[s.jsx("span",{className:`rank-badge ${c===0?"highlight":"normal"}`,children:c+1}),s.jsxs("div",{className:"viewed-info",children:[s.jsx("p",{className:"viewed-title",children:l.titulo}),s.jsxs("p",{className:"viewed-count",children:[l.visualizacoes," visualizaÃ§Ãµes"]})]})]},l.id))}):s.jsx("p",{className:"empty-state-text",children:"Nenhuma visualizaÃ§Ã£o registrada ainda"})]})]})},G=({imoveis:e,onDelete:o,onToggleStatus:d,filtro:l,setFiltro:c,busca:h,setBusca:m})=>s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"actions-bar",children:[s.jsxs("div",{className:"actions-header",children:[s.jsx("div",{className:"filter-buttons",children:["todos","ativos","venda","aluguel","rascunho"].map(i=>s.jsx("button",{onClick:()=>c(i),className:`filter-btn ${l===i?"active":"inactive"}`,children:i==="todos"?"Todos":i==="ativos"?"Ativos":i},i))}),s.jsxs("div",{style:{display:"flex",gap:"8px"},children:[s.jsxs(v,{to:"/admin/terrenos/novo",className:"btn-new",style:{backgroundColor:"#10b981"},children:[s.jsx(N,{size:20})," Novo Terreno"]}),s.jsxs(v,{to:"/cadastro-imovel",className:"btn-new",children:[s.jsx(N,{size:20})," Novo ImÃ³vel"]})]})]}),s.jsxs("div",{className:"search-wrapper",children:[s.jsx(I,{size:20,className:"search-icon"}),s.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar por tÃ­tulo, endereÃ§o ou bairro...",value:h,onChange:i=>m(i.target.value)})]})]}),s.jsxs("div",{className:"imoveis-list-container",children:[s.jsx("div",{className:"list-header",children:s.jsxs("h3",{children:["ðŸ“‹ Lista de ImÃ³veis (",e.length,")"]})}),s.jsxs("div",{className:"list-content",children:[e.map(i=>s.jsxs("div",{className:`imovel-item ${i.ativo===!1?"inactive":i.destaque?"destaque":"active"}`,children:[s.jsxs("div",{className:"imovel-info",children:[s.jsx("img",{src:i.imagens?.[0]||"/sem-foto.png",alt:"Capa",className:"imovel-thumb",loading:"lazy"}),s.jsxs("div",{className:"imovel-details",children:[s.jsxs("h4",{children:[i.titulo," ",i.destaque&&s.jsx("span",{className:"badge-destaque",children:"â­ DESTAQUE"})]}),s.jsxs("div",{className:"imovel-meta",children:[s.jsxs("span",{className:"meta-row",children:[s.jsx(b,{size:12})," ",i.tipo," â€¢",s.jsx(f,{size:12}),Number(i.preco).toLocaleString("pt-BR",{style:"currency",currency:"BRL",maximumFractionDigits:0})]}),s.jsxs("span",{className:"meta-row",children:[s.jsx(B,{size:12})," ",i.endereco,i.bairro&&` - ${i.bairro}`]})]}),i.ativo===!1&&s.jsx("span",{className:"badge-draft",children:"RASCUNHO"})]})]}),s.jsxs("div",{className:"item-actions",children:[s.jsx(v,{to:i.categoria==="Terreno"?`/admin/terrenos/editar/${i.id}`:`/editar/${i.id}`,className:"action-btn edit",title:"Editar",children:s.jsx(O,{size:18})}),s.jsx("button",{onClick:()=>d(i.id,i.ativo??!0),className:`action-btn toggle ${i.ativo===!1?"inactive":""}`,title:i.ativo===!1?"Publicar":"Ocultar",children:i.ativo===!1?s.jsx(U,{size:18}):s.jsx(g,{size:18})}),s.jsx("button",{onClick:()=>o(i.id),className:"action-btn delete",title:"Excluir",children:s.jsx(P,{size:18})})]})]},i.id)),e.length===0&&s.jsxs("div",{className:"empty-state-list",children:[s.jsx("p",{className:"empty-title",children:h?"ðŸ” Nenhum imÃ³vel encontrado com esse termo":"ðŸ“­ Nenhum imÃ³vel nesta categoria"}),s.jsx("p",{className:"empty-desc",children:h?"Tente buscar por outro termo":'Clique em "Novo ImÃ³vel" para comeÃ§ar'})]})]})]})]}),Y=()=>{k({title:"Painel Administrativo",description:"Dashboard de gerenciamento de imÃ³veis."});const[e,o]=n.useState([]),[d,l]=n.useState(!0),[c,h]=n.useState("todos"),[m,i]=n.useState(""),y=async()=>{try{const a=(await C($(j,"imoveis"))).docs.map(r=>({id:r.id,...r.data()}));o(a)}catch(t){console.error("Erro ao buscar imÃ³veis:",t)}finally{l(!1)}};n.useEffect(()=>{y()},[]);const z=n.useMemo(()=>{const t=new Date;return t.setDate(t.getDate()-30),{totalImoveis:e.length,imoveisAtivos:e.filter(a=>a.ativo!==!1).length,imoveisVenda:e.filter(a=>a.tipo==="Venda"||a.tipo==="Ambos").length,imoveisAluguel:e.filter(a=>a.tipo==="Aluguel"||a.tipo==="Ambos").length,totalVisualizacoes:e.reduce((a,r)=>a+(r.visualizacoes||0),0),cadastradosUltimos30Dias:e.filter(a=>a.criadoEm?("toDate"in a.criadoEm?a.criadoEm.toDate():a.criadoEm instanceof Date?a.criadoEm:new Date)>=t:!1).length,semFoto:e.filter(a=>!a.imagens||a.imagens.length===0).length,emDestaque:e.filter(a=>a.destaque===!0).length,valorMedioVenda:Math.round(e.filter(a=>a.tipo==="Venda"||a.tipo==="Ambos").reduce((a,r)=>a+r.preco,0)/(e.filter(a=>a.tipo==="Venda"||a.tipo==="Ambos").length||1))}},[e]),D=n.useMemo(()=>e.filter(t=>{if(c==="venda"&&t.tipo!=="Venda"&&t.tipo!=="Ambos"||c==="aluguel"&&t.tipo!=="Aluguel"&&t.tipo!=="Ambos"||c==="rascunho"&&t.ativo!==!1||c==="ativos"&&t.ativo===!1)return!1;if(m){const a=m.toLowerCase();return t.titulo.toLowerCase().includes(a)||t.endereco.toLowerCase().includes(a)||t.bairro&&t.bairro.toLowerCase().includes(a)}return!0}),[e,c,m]),A=n.useMemo(()=>[...e].filter(t=>(t.visualizacoes||0)>0).sort((t,a)=>(a.visualizacoes||0)-(t.visualizacoes||0)).slice(0,5),[e]),w=n.useMemo(()=>({ate200k:e.filter(t=>t.preco<=2e5).length,de200a400k:e.filter(t=>t.preco>2e5&&t.preco<=4e5).length,de400a600k:e.filter(t=>t.preco>4e5&&t.preco<=6e5).length,acima600k:e.filter(t=>t.preco>6e5).length}),[e]),E=async t=>{if(window.confirm("Tem certeza que deseja excluir? Essa aÃ§Ã£o Ã© permanente."))try{await L(p(j,"imoveis",t)),o(r=>r.filter(u=>u.id!==t))}catch(r){console.error("Erro ao excluir:",r),alert("Erro ao excluir.")}},S=async(t,a)=>{try{const r=!a;await q(p(j,"imoveis",t),{ativo:r}),o(u=>u.map(x=>x.id===t?{...x,ativo:r}:x))}catch(r){console.error("Erro ao atualizar status:",r)}};return d?s.jsx("div",{className:"loading-state",children:"Carregando painel..."}):s.jsxs("div",{className:"admin-container",children:[s.jsxs("div",{className:"admin-header",children:[s.jsx("h2",{children:"ðŸ“Š Dashboard Administrativo"}),s.jsx("p",{children:"VisÃ£o geral dos seus imÃ³veis e estatÃ­sticas"})]}),s.jsx(H,{stats:z}),s.jsx(Q,{faixasPreco:w,maisVisualizados:A}),s.jsx(G,{imoveis:D,onDelete:E,onToggleStatus:S,filtro:c,setFiltro:h,busca:m,setBusca:i})]})};export{Y as Admin};
